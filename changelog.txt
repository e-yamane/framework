RDF Core Change Log
===================

0.8から0.8.1の変更点(2009.4.16)
 [Bug]
    - makeSchemaAccessor実行時にスキーマプロパティが作成されない

0.8.1から???への変更点(2009.xx.xx)
  [Improvement]
    - ExtractorにfetchSizeを指定することでResultSetのフェッチサイズを
      変更できるようにしました。デフォルトはHibernate依存です
    - ユニークチェックをExtractor+PropertyUtilsで行うように変更しました。
　　　（性能改善）この変更に伴いHibernateに依存しないコードが大部分に
　　　なったため、ユニークチェックの処理をBasicServiceへ移動
    - jp.rough_diamond.commons.util.jobmonitor.ContextListenerを新規作成
      Webアプリケーション上からJobMonitorを起動するためのリスナ。
　　　context-param(name="monitorName")で指定されたJobMonitorをDIコンテナより
      取得/実行を行う。省略した場合はjobMonitorと言う名前でDIコンテナから
      取得する
    - JavaVM毎に一意にユーザーを管理するSimpleUserControllerを新規作成
    - 常にアクセス許可を返すSimpleRoleJudgeを作成
    - crontabの実行時間指定文字列に完全準拠したHudsonCronTaskを新規作成
　　　名前とおり、hudsonの内部モジュールを使用しているので、hudson-core、
　　　localizerが必要となります。
    - プロジェクト作成用のタスクnewProjectを作成しました。
    - makeBean実行時に参照するファイル名を可変としました。デフォルトは
　　　「./beanDef/beanDef.xml」です。（プロパティ名は「bean.def.xml」
    - muleの自動生成時にcfxrouting.propertiesに記述したエントリを可変にしました。
　　　下位互換性を保つため
    - 戻り値があるSOAが正しく動作するようにした
    - Extractorで集計関数（sum、avg、max、min, count）をサポート
    - 算術演算用のクラス（FreeFormat）をサポート
    - Extractorでhavingをサポート
    - 戻り値の型を指定できるようにしました
　　- プロパティ同士の比較を出来るようにしました
　　- Extractor#add*、CombineCondition#addの戻り値に自分自身を
　　　返却するようにしました
　　- 自動生成時にsaveメソッドを自動作成するようにしました。
    - ExtractValue使用時にdistinctの指定ができるようにしました。
　　- BasicService#findAllにレコードロックのモードを指定できるようにしました。
　　- BasicServiceのリファクタリングを実施し、findByExtractorWithCountを抽象メソッドから
　　　具象メソッドに変更し、getCountByExtractorを抽象メソッドに変更した。
　　　findByExtractorWithCountの戻り値は、findByExtractor+getCountByExtractorであるため、
　　　具象化可能。従来のgetCountByExtractorは、findByExtractorWithCountを呼び出して、
　　　件数だけ抜き出すという形での実装であった
　　- InnerJointの生成子にPropertyを受けれるものを追加しました。
　　- 永続化イベントのコールバックを外部オブジェクトでも受けれるようにしました。
　　　DIContainerにpersistenceEventListenersと言う名でListを渡すようにしておけば、
　　　そのList内のオブジェクトの然るべきメソッドにイベントを伝播させることができます。
　　- commons-logging.propertiesを追加してlog4jでログを出力するようにしました。
　　- makeBean実行時にsrc.encodingプロパティが指定されていればその文字コードで
　　　ソースコードを生成するようにしました。（デフォルトはMS932）
　　- BasicService#clearCacheメソッドを追加。
　　　org.hibernate.Session.evictを隠ぺいするのが目的です。
　　- テストデータのローディング方法を刷新しました。
　　- AntコマンドにclearTestDataを追加しました。
　　- テーブル定義ファイルでindex/uniqueを指定する場合に、内部参照テーブルのカラムを
　　　指定できるようにしました。
　　- １つのWSDLファイル内に複数のoperationが定義されている場合でも、処理可能な
　　　スタブクラスとmuleの設定ファイルを自動生成できるようにした。
　　- SOAの引数/戻り値にMapオブジェクトを使用できるようにしました。
　　- org.mule.api.transformer.TransformerExceptionを継承した
　　　MessagesIncludingTransformerExceptionを新設しました。
　　　変換失敗した際にRDFのリソース制御アーキテクチャに合わせることができます。
　　- スキーマ定義時にタイプをTIMESTAMPにした場合にOracleのカラムタイプをTIMESTAMPと
　　　なるように変更しました。
　　- オブジェクト永続化時のユニークチェックの性能向上を実施しました
　　- FindResultにgetterメソッドを作成しました。
　　- jp.rough_diamond.commons.entity.ScalableNumber生成時に整数部の数値がLong.MAX_VALUEを
　　　超えていた場合の丸め処理の性能を向上しました。
　　- makeClientStubコマンドで自動生成されるmule-config.xmlでtransformerはinboundで行うのではなく、
      outboundで行うように変更
　　- makeSchemaAccessorでエラーが発生した場合、以降の自動生成タスクは行わないようにする
  [Bug]
    - jp.rough_diamond.commons.resource.SimpleLocaleControllerコメント誤り
    - テスト実行前にcobertura.serを削除していない。そのため削除したクラスの
　　　カバレッジや、通過していないパスのカバレッジを計上していた
　　- TransactionAttributeがREQUIRED_NEWのサービスがネストした場合、
　　　下位トランザクションでsetRollbackOnlyした場合に、上位トランザクションも
　　　強制ロールバックされてしまう。
　　　REQUIRED->REQUIRED_NEWの場合は発生しない。
　　　REQUIRED->REQUIREDの場合は、そもそも連鎖させるので問題ない。
　　　REQUIRED->REQUIRED_NEW->REQUIREDの場合も同様の不具合が発生していた
　　- findAllを使用すると、ターゲットのオブジェクト以外のオブジェクトに
　　　PostLoadイベントがコールバックされない
　　- 引数がないSOAの呼び出しを行うとNullPointerExceptionが発生する
　　- makeSchemaAccessor実行後、プロパティファイルをnative2asciiするために、
　　　makeConfigを呼び出していたが、この方法では、ログイン名と違うconfigを使用した場合に
　　　不具合が生じてしますため、native2asciiのみを実行するように修正した。
　　- 複雑なJOINを多用すると想定しているHQLを出力しない
　　- タイプ指定をして、targetとは異なるオブジェクトのプロパティでソート順を指定すると
　　　HQLの文法エラーとなる不具合を発見/対処しました
　　- jp.rough_diamond.commons.entity.ScalableNumber生成時に、整数部の数値が
　　　Long.MIN_VALUEを下回っている場合に、正しく値を保持できていない不具合を
　　　発見/対処しました。
　　- PropertyUtils#copyPropertiesメソッドで以下の条件を満たすプロパティを有する
　　　オブジェクトのコピーを行うとNullPointerExceptionが発生する
　　　　１．コレクションではないプロパティ
　　　　２．配列でもないプロパティ
　　　　３．コピー元のオブジェクトをコピー先へコピーできないプロパティ
　　　　４．コピー先のオブジェクトにsetterメソッドはあってもgetterメソッドがないプロパティ
　　- スキーマ定義において、内部コンポーネントのテーブル名と参照しているテーブル名に
　　　一致している文字列を含んでいる場合にmakeSchemaAccessor実行時にエラーが発生する
  [Reduced]
　　- MultiLanguageMasterLoaderを削除。現状使用していない。
　　　ローダーレベルでサポートするものではない
　　- TransactionManagerをabstractにしました。TransactionManagerを使用している場合は、
　　　jp.rough_diamond.framework.transaction.SimpleTransactionManagerを指定してください